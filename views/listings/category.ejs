<%- layout('layouts/boilerplate') %>
<%- include('../includes/signInPopup.ejs') %> 
<%- include('../includes/categoryFilterPopup.ejs', { 
  categoryListings: categoryListings,
  currentCategory: categoryListings.length > 0 ? categoryListings[0].category : ''
}) %>
<%- include('../includes/filters.ejs') %>


<% if(categoryListings.length === 0) { %>
    <div class="no-results offset-lg-1 col-lg-6 d-flex flex-column align-items-center justify-content-center  ">
      <dotlottie-player src="https://lottie.host/b4a87ee7-5102-4d24-accd-429098a26948/TrnHGKSryb.lottie" background="transparent" speed="1" style="width: 300px; height: 300px" loop autoplay></dotlottie-player>
        <h3>No listings found for this category</h3>
        <a href="/listings" class="btn btn-outline-dark">Back to all listings</a>
    </div>
<% } else { %>
    <div class="row index-box">
        <% for(let listing of categoryListings) { %>
          <div class="box col-lg-3 col-md-4 col-sm-6 col-12 mt-2">
            <a class="d-block showLink" href="/listings/<%=listing.id%>">
              <div class="card">
                <img src="<%=listing.image.url%>" class="card-img-top" alt="<%=listing.title%>" />
                <div class="card-img-overlay"></div>
                <div class="card-body">
                  <p class="card-text">
                    <b><%= listing.title %></b>
                    <br />
                    &#8377;<%=listing.price%> /night
                  </p>
                </div>
              </div>
            </a>
          </div>
        <% } %>
    </div>
<% } %>

<!-- Include necessary scripts -->
<script src="/js/filter.js"></script>
<script src="/js/signinPopup.js"></script>
<script src="/js/filterPopup.js"></script>



